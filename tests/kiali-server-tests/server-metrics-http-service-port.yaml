name: "server_metrics_http_service_port"
description: "Verify metrics Service port uses http-metrics name and http appProtocol when TLS disabled"
helm_args:
  - "--set"
  - "server.observability.metrics.enabled=true"
yq_query: >
  select(.kind == "Service") |
  .spec.ports[] | select(.port == 9090) |
  {"name": .name, "appProtocol": .appProtocol}
expected_result: |
  name: http-metrics
  appProtocol: http
should_fail: false
