name: "clusterrole_openshift_absent_when_not_needed"
description: "ClusterRole (OpenShift) should not be rendered when auth.strategy != openshift AND tls_config.source=config"
helm_args:
  - "--set"
  - "isOpenShift=true"
  - "--set"
  - "auth.strategy=anonymous"
  - "--set"
  - "deployment.tls_config.source=config"
yq_query: >
  select(.kind == "ClusterRole" and (.metadata.name | test("-openshift$"))) | .kind
expected_result: |
should_fail: false
