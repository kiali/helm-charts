name: "ingress_configuration"
description: "Verify ingress class name and additional labels configuration"
helm_args:
  - "--set"
  - "deployment.ingress.enabled=true"
  - "--set"
  - "deployment.ingress.class_name=traefik"
  - "--set"
  - "deployment.ingress.additional_labels.environment=production"
  - "--set"
  - "deployment.ingress.additional_labels.team=platform"
yq_query: "select(.kind == \"Ingress\") | {\"ingressClassName\": .spec.ingressClassName, \"additionalLabels\": (.metadata.labels | with_entries(select(.key == \"environment\" or .key == \"team\")))}"
expected_result: |
  ingressClassName: traefik
  additionalLabels:
    environment: production
    team: platform
should_fail: false
